import{BigNumber as f,ethers as o,utils as t}from"ethers";var r=f.from("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),e=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,167,173,179,181,191,193,199,203,207,211,227,233,239,251,257,263,269,281,293,307,311,317,337,347,353,359,379,389,401,409,419,431,443,449,461,467,479,487,491,499,503],i=/*#__PURE__*/function(){function i(){this.publicAddress=void 0,this.mnemonic=void 0,this.polynomialS=void 0,this.polynomialA1=void 0;var t=o.Wallet.createRandom();console.log(t),this.publicAddress=t.address,this.mnemonic=t.mnemonic.phrase,this.polynomialS=f.from(t.privateKey),this.polynomialA1=this.randomNumber()}var n=i.prototype;return n.replaceWallet=function(t){var r=new o.Wallet(t);this.publicAddress=r.address,this.mnemonic=null,this.polynomialS=f.from(t),this.polynomialA1=this.randomNumber()},n.randomNumber=function(){return f.from(t.randomBytes(32))},n.findY=function(f){return this.polynomialS.add(f.mul(this.polynomialA1))},n.createShares=function(o){for(var t=[],r=0;r<o;r++)t=[].concat(t,[{x:f.from(e[r]),y:this.findY(f.from(e[r]))}]);return t},n.reconstructPrivateKey=function(f,o){return f.y.mul(o.x).div(o.x.sub(f.x)).add(o.y.mul(f.x).div(f.x.sub(o.x))).mod(r)},n.test=function(){console.log("private key: ",this.polynomialS);var f=this.createShares(5);console.log(f);var o=this.reconstructPrivateKey(f[0],f[1]);console.log("reconstruct private key 12: ",o);var t=this.reconstructPrivateKey(f[0],f[4]);console.log("reconstruct private key 14: ",t);var r=this.reconstructPrivateKey(f[3],f[4]);console.log("reconstruct private key 45: ",r)},i}();console.log(r),(new i).test();
