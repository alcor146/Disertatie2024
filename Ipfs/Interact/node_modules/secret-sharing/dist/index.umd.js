!function(e,f){"object"==typeof exports&&"undefined"!=typeof module?f(require("ethers")):"function"==typeof define&&define.amd?define(["ethers"],f):f((e||self).ethers)}(this,function(e){var f=e.BigNumber.from("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),o=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,167,173,179,181,191,193,199,203,207,211,227,233,239,251,257,263,269,281,293,307,311,317,337,347,353,359,379,389,401,409,419,431,443,449,461,467,479,487,491,499,503],t=/*#__PURE__*/function(){function t(){this.publicAddress=void 0,this.mnemonic=void 0,this.polynomialS=void 0,this.polynomialA1=void 0;var f=e.ethers.Wallet.createRandom();console.log(f),this.publicAddress=f.address,this.mnemonic=f.mnemonic.phrase,this.polynomialS=e.BigNumber.from(f.privateKey),this.polynomialA1=this.randomNumber()}var r=t.prototype;return r.replaceWallet=function(f){var o=new e.ethers.Wallet(f);this.publicAddress=o.address,this.mnemonic=null,this.polynomialS=e.BigNumber.from(f),this.polynomialA1=this.randomNumber()},r.randomNumber=function(){return e.BigNumber.from(e.utils.randomBytes(32))},r.findY=function(e){return this.polynomialS.add(e.mul(this.polynomialA1))},r.createShares=function(f){for(var t=[],r=0;r<f;r++)t=[].concat(t,[{x:e.BigNumber.from(o[r]),y:this.findY(e.BigNumber.from(o[r]))}]);return t},r.reconstructPrivateKey=function(e,o){return e.y.mul(o.x).div(o.x.sub(e.x)).add(o.y.mul(e.x).div(e.x.sub(o.x))).mod(f)},r.test=function(){console.log("private key: ",this.polynomialS);var e=this.createShares(5);console.log(e);var f=this.reconstructPrivateKey(e[0],e[1]);console.log("reconstruct private key 12: ",f);var o=this.reconstructPrivateKey(e[0],e[4]);console.log("reconstruct private key 14: ",o);var t=this.reconstructPrivateKey(e[3],e[4]);console.log("reconstruct private key 45: ",t)},t}();console.log(f),(new t).test()});
