var e=require("ethers"),f=e.BigNumber.from("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),r=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,167,173,179,181,191,193,199,203,207,211,227,233,239,251,257,263,269,281,293,307,311,317,337,347,353,359,379,389,401,409,419,431,443,449,461,467,479,487,491,499,503],o=/*#__PURE__*/function(){function o(){this.publicAddress=void 0,this.mnemonic=void 0,this.polynomialS=void 0,this.polynomialA1=void 0;var f=e.ethers.Wallet.createRandom();console.log(f),this.publicAddress=f.address,this.mnemonic=f.mnemonic.phrase,this.polynomialS=e.BigNumber.from(f.privateKey),this.polynomialA1=this.randomNumber()}var t=o.prototype;return t.replaceWallet=function(f){var r=new e.ethers.Wallet(f);this.publicAddress=r.address,this.mnemonic=null,this.polynomialS=e.BigNumber.from(f),this.polynomialA1=this.randomNumber()},t.randomNumber=function(){return e.BigNumber.from(e.utils.randomBytes(32))},t.findY=function(e){return this.polynomialS.add(e.mul(this.polynomialA1))},t.createShares=function(f){for(var o=[],t=0;t<f;t++)o=[].concat(o,[{x:e.BigNumber.from(r[t]),y:this.findY(e.BigNumber.from(r[t]))}]);return o},t.reconstructPrivateKey=function(e,r){return e.y.mul(r.x).div(r.x.sub(e.x)).add(r.y.mul(e.x).div(e.x.sub(r.x))).mod(f)},t.test=function(){console.log("private key: ",this.polynomialS);var e=this.createShares(5);console.log(e);var f=this.reconstructPrivateKey(e[0],e[1]);console.log("reconstruct private key 12: ",f);var r=this.reconstructPrivateKey(e[0],e[4]);console.log("reconstruct private key 14: ",r);var o=this.reconstructPrivateKey(e[3],e[4]);console.log("reconstruct private key 45: ",o)},o}();console.log(f),(new o).test();
